#requires -version 2


function Invoke-WMIStartProcess
{
<#
.SYNOPSIS
TBA
.DESCRIPTION
TBA
.PARAMETER TBA
.EXAMPLE
TBA
#>

    # Provide hidden flag for user to specify if they want it hidden or not
    $startup=[wmiclass]"Win32_ProcessStartup"
    $startup.Properties['ShowWindow'].value=$False
    ([wmiclass]"win32_Process").create('ping.exe -n 4 192.168.63.158','C:\',$startup)

}


function Invoke-WMIKillProcess
{
<#
.SYNOPSIS
TBA
Some of this is from - http://blogs.technet.com/b/heyscriptingguy/archive/2009/12/10/hey-scripting-guy-december-10-2009.aspx
.DESCRIPTION
TBA
.PARAMETER TBA
.EXAMPLE
TBA
#>

    Get-WmiObject -Class win32_Process -Filter "name = 'notepad.exe'" | ForEach-Object { $_.Terminate() }

}