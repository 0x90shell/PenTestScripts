#!/usr/bin/python

# Quick script that attempts to find the reverse DNS info
# from a provided IP range.

import os
import socket
from netaddr import IPNetwork


# Clear the screen
os.system('clear')

print "############################################################"
print "#                    Reverse DNS Scanner                   #"
print "############################################################\n"

print "Starting Reverse DNS Scan...\n"

# Define the network you want to scan
net_1 = IPNetwork('198.182.162.0/24')

# Loop through all IPs in the provided network range
for ip in net_1:
    ip = str(ip)
    try:
        # Get the reverse dns name if it exists
        reverse_dns = socket.gethostbyaddr(ip)[0]
        script_out = ip + ' ' + reverse_dns + '\n'
        with open('reverse_dns_results.txt', 'a') as rev_results:
            rev_results.write(script_out)
    except:
        print "No Reverse DNS for " + ip + "."


print "\nScan Completed! Check the output file!\n"
